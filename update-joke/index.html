<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>A new version is available!</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root {
    --xp-blue: #0a246a;
    --xp-blue-light: #3a6ea5;
    --xp-title-text: #ffffff;
    --xp-gray: #ece9d8;
    --xp-darker-gray: #d4d0c8;
    --xp-shadow: #404040;
    --xp-highlight: #ffffff;
    --xp-text: #000;
  }

  html, body {
    height: 100%;
  }
  body {
    margin: 0;
    background: linear-gradient(#3a6ea5, #24527a);
    font-family: Tahoma, Verdana, Segoe UI, sans-serif;
    color: var(--xp-text);
    display: grid;
    place-items: center;
    user-select: none;
  }

  .desktop {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .window {
    position: absolute;
    width: 360px;
    background: var(--xp-gray);
    border: 2px solid var(--xp-shadow);
    box-shadow: 6px 6px 0 rgba(0,0,0,0.3);
  }
  .titlebar {
    height: 28px;
    background: linear-gradient(180deg, var(--xp-blue-light) 0%, var(--xp-blue) 100%);
    color: var(--xp-title-text);
    display: flex;
    align-items: center;
    padding: 0 6px;
    cursor: move;
  }
  .titlebar .icon {
    width: 16px; height: 16px;
    margin-right: 6px;
    background: radial-gradient(#fff, #c0d6f9);
    border: 1px solid rgba(255,255,255,0.6);
  }
  .titlebar .title {
    font-weight: bold;
    font-size: 12px;
    flex: 1;
    text-shadow: 0 1px 0 rgba(0,0,0,0.35);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .titlebar .controls {
    display: flex; gap: 4px;
  }
  .control-btn {
    width: 18px; height: 18px;
    background: var(--xp-gray);
    border: 1px solid var(--xp-shadow);
    display: grid; place-items: center;
    font-size: 12px; font-weight: bold;
    line-height: 1;
  }

  .content {
    padding: 14px 14px 8px;
    display: grid;
    grid-template-columns: 48px 1fr;
    grid-gap: 10px;
  }
  .shield {
    width: 48px; height: 48px;
    background:
      radial-gradient(#ffcf00, #d38e00);
    border-radius: 6px;
    border: 2px solid #b67a00;
    box-shadow: inset 0 0 0 2px rgba(255,255,255,0.4);
  }
  .message {
    font-size: 14px;
  }

  .buttons {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    padding: 12px 10px 12px;
    background: linear-gradient(#fff, #ece9d8);
    border-top: 1px solid var(--xp-darker-gray);
  }

  button {
    font-family: Tahoma, Verdana, Segoe UI, sans-serif;
    font-size: 12px;
    padding: 6px 14px;
    background: #e3e3e3;
    color: #000;
    border: 1px solid #777;
    box-shadow:
      inset 1px 1px 0 var(--xp-highlight),
      inset -1px -1px 0 #b5b5b5;
    cursor: pointer;
  }
  button:active {
    box-shadow:
      inset -1px -1px 0 var(--xp-highlight),
      inset 1px 1px 0 #b5b5b5;
  }
  .default {
    border: 2px solid #0a246a;
    padding: 5px 13px;
  }

  .status {
    font-size: 11px;
    color: #333;
    padding: 0 10px 10px;
  }
</style>
</head>
<body>
  <div class="desktop" id="desktop">
    <div class="window" id="win" style="left: 50%; top: 50%; transform: translate(-50%, -50%);">
      <div class="titlebar" id="drag">
        <div class="icon"></div>
        <div class="title">A new version is available!</div>
        <div class="controls">
          <div class="control-btn" title="Minimize">â€“</div>
          <div class="control-btn" title="Maximize">â–¡</div>
          <div class="control-btn" title="Close">Ã—</div>
        </div>
      </div>
      <div class="content">
        <div class="shield" aria-hidden="true"></div>
        <div class="message">
          <div style="font-weight:bold; margin-bottom:6px;">Do you want to update?</div>
          The latest version is ready to install.
        </div>
      </div>
      <div class="buttons" id="buttons">
        <button class="default" id="btnUpdateNow" accesskey="U">Update now</button>
        <button id="btnLater" accesskey="L">Update later</button>
      </div>
      <div class="status" id="status">Tip: Press <u>U</u> for Update now, <u>L</u> for Update later.</div>
    </div>
  </div>

<script>
  (function makeDraggable() {
    const win = document.getElementById('win');
    const drag = document.getElementById('drag');
    let offsetX = 0, offsetY = 0, dragging = false;

    drag.addEventListener('mousedown', e => {
      dragging = true;
      const rect = win.getBoundingClientRect();
      offsetX = e.clientX - rect.left;
      offsetY = e.clientY - rect.top;
      win.style.transform = '';
      e.preventDefault();
    });
    window.addEventListener('mousemove', e => {
      if (!dragging) return;
      const maxX = window.innerWidth - win.offsetWidth;
      const maxY = window.innerHeight - win.offsetHeight;
      let x = Math.min(Math.max(0, e.clientX - offsetX), maxX);
      let y = Math.min(Math.max(0, e.clientY - offsetY), maxY);
      win.style.left = x + 'px';
      win.style.top = y + 'px';
    });
    window.addEventListener('mouseup', () => dragging = false);
  })();

  const btnLater = document.getElementById('btnLater');
  const btnNow = document.getElementById('btnUpdateNow');
  const buttonsBar = document.getElementById('buttons');
  const status = document.getElementById('status');
  const win = document.getElementById('win');

  let swapCount = 0;
  let lastHop = 0;

  function swapButtons() {
    if (buttonsBar.firstElementChild === btnNow) {
      buttonsBar.insertBefore(btnLater, btnNow);
    } else {
      buttonsBar.insertBefore(btnNow, btnLater);
    }
    swapCount++;
    status.textContent = `Nice tryâ€¦ (${swapCount})`;
  }

  function near(element, pointerX, pointerY, radius = 80) {
    const r = element.getBoundingClientRect();
    const cx = r.left + r.width / 2;
    const cy = r.top + r.height / 2;
    const dx = pointerX - cx;
    const dy = pointerY - cy;
    return (dx * dx + dy * dy) < (radius * radius);
  }

  window.addEventListener('mousemove', (e) => {
    if (near(btnLater, e.clientX, e.clientY, 80)) {
      /*swapButtons();
      const now = performance.now();
      if (now - lastHop > 250 && Math.random() < 0.3) {
        lastHop = now;
        const rect = win.getBoundingClientRect();
        const hopX = (Math.random() * 120 - 60) | 0;
        const hopY = (Math.random() * 80 - 40) | 0;
        let newX = Math.min(Math.max(0, rect.left + hopX), window.innerWidth - rect.width);
        let newY = Math.min(Math.max(0, rect.top + hopY), window.innerHeight - rect.height);
        win.style.left = newX + 'px';
        win.style.top = newY + 'px';
      }
        */
    }
  });

  btnLater.addEventListener('mouseenter', swapButtons);

  window.addEventListener('keydown', (e) => {
    if (e.key.toLowerCase() === 'u') {
      acceptUpdate();
    } else if (e.key.toLowerCase() === 'l') {
      swapButtons();
    } else if (e.key === 'Escape') {
      status.textContent = 'Escape wonâ€™t save you ðŸ˜ˆ';
    }
  });

  btnNow.addEventListener('click', acceptUpdate);
  btnLater.addEventListener('click', () => { swapButtons(); });

  function acceptUpdate() {
    const html = `
      <div class="content" style="grid-template-columns: 1fr;">
        <div class="message" style="text-align:center">
          <div style="font-weight:bold; margin-bottom:8px;">Installing updatesâ€¦</div>
          <div id="bar"
               style="width:100%; height:18px; border:1px solid #777; background:#fff; box-shadow: inset 1px 1px 0 #fff, inset -1px -1px 0 #b5b5b5;">
            <div id="fill" style="height:100%; width:0%; background:#3a6ea5;"></div>
          </div>
          <div id="pct" style="margin-top:8px;">0%</div>
        </div>
      </div>
      <div class="buttons">
        <button disabled>Cancel</button>
      </div>
      <div class="status">Applying hotfix KB8675309â€¦</div>
    `;
    win.innerHTML = `
      <div class="titlebar" id="drag2">
        <div class="icon"></div>
        <div class="title">A new version is available!</div>
        <div class="controls">
          <div class="control-btn" title="Minimize">â€“</div>
          <div class="control-btn" title="Maximize">â–¡</div>
          <div class="control-btn" title="Close">Ã—</div>
        </div>
      </div>
      ${html}
    `;

    (function rebindDrag() {
      const drag = document.getElementById('drag2');
      let offsetX = 0, offsetY = 0, dragging = false;
      drag.addEventListener('mousedown', e => {
        dragging = true;
        const rect = win.getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;
        e.preventDefault();
      });
      window.addEventListener('mousemove', e => {
        if (!dragging) return;
        const maxX = window.innerWidth - win.offsetWidth;
        const maxY = window.innerHeight - win.offsetHeight;
        const x = Math.min(Math.max(0, e.clientX - offsetX), maxX);
        const y = Math.min(Math.max(0, e.clientY - offsetY), maxY);
        win.style.left = x + 'px';
        win.style.top = y + 'px';
      });
      window.addEventListener('mouseup', () => dragging = false);
    })();

    const fill = () => document.getElementById('fill');
    const pct = () => document.getElementById('pct');
    let p = 0;
    const t = setInterval(() => {
      p += Math.random() * 4;
      if (p > 99) p = 99;
      if (!fill()) { clearInterval(t); return; }
      fill().style.width = p.toFixed(0) + '%';
      pct().textContent = p.toFixed(0) + '%';
    }, 300);
  }

  window.addEventListener('load', () => {
    const rect = win.getBoundingClientRect();
    win.style.left = (window.innerWidth - rect.width) / 2 + 'px';
    win.style.top = (window.innerHeight - rect.height) / 2 + 'px';
    win.style.transform = '';
  });
  window.addEventListener('resize', () => {
    const rect = win.getBoundingClientRect();
    let x = Math.min(Math.max(0, rect.left), window.innerWidth - rect.width);
    let y = Math.min(Math.max(0, rect.top), window.innerHeight - rect.height);
    win.style.left = x + 'px';
    win.style.top = y + 'px';
  });
</script>
</body>
</html>
